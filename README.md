# Medusa Plugin Ultimate

The Medusa Plugin Ultimate is a powerful tool that allows developers to easily add a user interface to entities marked with a decorator. With this plugin, you can seamlessly create, edit, view, and delete documents associated with these entities, and expose them through a specific route for your store.

## Features

- **Entity UI Integration:** The Medusa Plugin Ultimate seamlessly integrates with your entities. By simply marking an entity with a decorator, you can enable a user interface for it in the Medusa dashboard.

- **Create, Edit, View, Delete:** Once your entity has a UI, you can easily perform essential CRUD operations. Create new documents, edit existing ones, view their details, and delete them with ease.

- **Customizable UI:** The UI generated by this plugin is customizable, allowing you to tailor it to your specific requirements. You can control the appearance and behavior of the UI elements.

- **Route Exposition:** In addition to the dashboard integration, this plugin exposes your entity documents via a specific route. This makes it easy for your store to interact with these documents programmatically.

## Installation

1. **Install the Plugin:**

   ```shell
   npm i medusa-plugin-ultimate
   ```

   ```shell
   yarn add medusa-plugin-ultimate
   ```

   ```shell
   pnpm i medusa-plugin-ultimate
   ```

2. **Configure the Plugin:**

   **IMPORTANT:**
   this env variables are required on the admin: `MEDUSA_ADMIN_BACKEND_URL` or `BACKEND_URL`

   Edit the configuration files to specify the entities you want to add the UI for and configure other settings as needed.

   ```ts
   // medusa-config.js

   const plugins = [
     ///...other plugins
     {
       resolve: "medusa-plugin-ultimate",
       options: {
         enableUI: true,
       },
     },
   ];

   // ...
   ```

   <!-- - `enableUI`: enable the plugin changes to the UI, if set to false marked entities will not have ui. -->

## Usage

- **Mark your entity with our custom decorators:**

  Use our custom decorators:

  - `@UltimateEntity({})` on your class to create a ui for it.
  - `@UltimateEntityField({})` on your class fields.

  ```ts
  // src/models/person.ts

  import { BeforeInsert, Column, Entity, PrimaryColumn } from "typeorm";

  import { BaseEntity } from "@medusajs/medusa";
  import { generateEntityId } from "@medusajs/utils";

  import {
    UltimateEntity,
    UltimateEntityField,
    UltimateEntityFieldTypes,
  } from "medusa-plugin-ultimate/dist/index";

  export enum Gender {
    MALE = "MALE",
    FEMALE = "FEMALE",
    UNKNOWN = "UNKNOWN",
  }

  @Entity()
  @UltimateEntity({})
  export class Person extends BaseEntity {
    @Column({ type: "varchar", nullable: false })
    @UltimateEntityField({
      type: UltimateEntityFieldTypes.STRING,
    })
    name: string;

    @Column({ type: "varchar", nullable: true })
    @UltimateEntityField({
      type: UltimateEntityFieldTypes.IMAGE,
    })
    image: string;

    @Column({ type: "enum", default: Gender.UNKNOWN, enum: Gender })
    @UltimateEntityField({
      name: "Gender",
      type: UltimateEntityFieldTypes.SELECT,
      options: [
        {
          value: Gender.MALE,
          label: "Male",
        },
        {
          value: Gender.FEMALE,
          label: "Female",
        },
        {
          value: Gender.UNKNOWN,
          label: "Unknown",
        },
      ],
      description: "The person gender",
    })
    gender: Gender;

    @UltimateEntityField({
      type: UltimateEntityFieldTypes.BOOLEAN,
    })
    @Column({ type: "bool", default: false })
    isPublic: boolean;

    @BeforeInsert()
    private beforeInsert(): void {
      this.id = generateEntityId(this.id, "person");
    }
  }
  ```

- **`UltimateEntity()`:**

  ```ts
  UltimateEntityField({
      name: "Name displayed on the entity page.";
      description: "Description displayed on the entity page";
  })
  ```

  | Param       | Type     | Details                     |
  | ----------- | -------- | --------------------------- |
  | name        | `string` | Will be displayed on the ui |
  | description | `string` | Will be displayed on the ui |

- **`UltimateEntityField()`:**

  ```ts
  UltimateEntityField({
      type: UltimateEntityFieldTypes.STRING;
      defaultValue?: "default-name";
      variant?: UltimateEntityFieldTypeMap[T];
      note?: "will appear when hover on infos icon of the field.";
      name?: "field name.";
      description?: "field description";
      // only for fields with type set to UltimateEntityFieldTypes.SELECT
      options?: [
         {
            value: "first-value",
            label: "first-label"
         },
         // other options here..
      ];
  })
  ```

  | Param           | Type                                 | Details                                                                                 |
  | --------------- | ------------------------------------ | --------------------------------------------------------------------------------------- |
  | type (required) | `UltimateEntityFieldTypes`           | Will be displayed on the ui                                                             |
  | defaultValue    | `any`                                | Will be used if no value is provided on creation of a document from the admin dashboard |
  | variant         | `UltimateEntityFieldComponents`      | UI Component used for that field                                                        |
  | note            | `string`                             | Text do display when UI field is hovered                                                |
  | name            | `string`                             | Will be displayed on the UI field as a label                                            |
  | description     | `string`                             | Will be displayed on the UI field, on the bottom                                        |
  | options         | `{ label: string, value: string }[]` | Required if the field type is a SELECT `UltimateEntityFieldTypes.SELECT`                |

- **`UltimateEntityFieldTypes`:**
  ```ts
  export enum UltimateEntityFieldTypes {
    STRING = "STRING",
    TEXT = "TEXT",
    BOOLEAN = "BOOLEAN",
    IMAGE = "IMAGE",
    SELECT = "SELECT",
    ONE_TO_MANY_RELATION_SELECT = "ONE_TO_MANY_RELATION_SELECT",
    UNKNOWN = "UNKNOWN",
    STRING_ARRAY = "STRING_ARRAY",
    DATE = "DATE",
    MARKDOWN = "MARKDOWN",
    COLOR = "COLOR",
  }
  ```

## Endpoints

we gonna take this entity as an example

```ts
// src/models/person.ts

@Entity()
@UltimateEntity()
export class BlogPost extends BaseEntity {
  // code...
}
```

the entity id will be <u>**blog_post**</u>

- ## List Entity Documents:

  Will return all the documents of the given ultimate-entity-id.

  ### Endpoint

  **GET:** `<BACKEND_URL>/store/ultimate-entities/<ULTIMATE_ENTITY_ID>/documents`

  ### Path Parameters

  | Param     | Type                 | Details                                                                                                                              |
  | --------- | -------------------- | ------------------------------------------------------------------------------------------------------------------------------------ |
  | `<field>` | `string \| string[]` | Any of your document field to filter on, example: title=brand-name-1,brand-name-2: will return all documents with one of this titles |
  | limit     | `number`             | The number of products to skip when retrieving the documents                                                                         |
  | offset    | `number`             | Will be displayed on the ui                                                                                                          |
  | order     | `string \| string[]` | A document field(s) to sort-order the retrieved documents by.                                                                        |
  | q         | `string`             | Used to search on documents fields specified in the @UltimateEntity decorator                                                        |

  ### Response

  ```ts
  {
    documents: {
      id: string;
      /**
       * other fields of your entity
       */
      updated_at: string;
      created_at: string;
      // deleted_at: string;
    }
    [];
  }
  ```

- ## Retreive Entity Document:

  Retreive an ultimate entity document with it's id.

  ### Endpoint

  **GET:** `<BACKEND_URL>/store/ultimate-entities/<ULTIMATE_ENTITY_ID>/documents/<DOCUMENT_ID>`

  ### Path Parameters

  | Param | Type | Details |
  | ----- | ---- | ------- |

  ### Response

  ```ts
  {
    document: {
      id: string;
      /**
       * other fields of your entity
       */
      updated_at: string;
      created_at: string;
      // deleted_at: string;
    }
    [];
  }
  ```
